<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.8">
<title>Registry</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock pre.nowrap,.literalblock pre.nowrap pre,.listingblock pre.nowrap,.listingblock pre.nowrap pre{white-space:pre;word-wrap:normal}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #dddddf}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt,.quoteblock .quoteblock{margin:0 0 1.25em;padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
<h1>Registry</h1>
</div>
<div id="content">
<div class="sect1">
<h2 id="overview">Image Registry</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="registry-integrated-openshift-registry-architecture-component-imageregistry">Integrated OpenShift Enterprise registry</h3>
<div class="paragraph">
<p>OpenShift Enterprise provides a built in container image registry which runs as a
standard workload on the cluster. The registry is configured and managed by an
infrastructure operator. It provides an out of the box solution for users to
manage the images that run their workloads, and runs on top of the existing
cluster infrastructure. This registry can be scaled up or down like any other
cluster workload and does not require specific infrastructure provisioning. In
addition, it is integrated into the cluster user authentication and
authorization system which means that access to create and retrieve images is
controller by defining user permissions on the image resources.</p>
</div>
<div class="paragraph">
<p>The registry is typically used as a publication target for images built on the
cluster as well as a source of images for workloads running on the cluster.
When new a new image is pushed to the registry, the cluster is notified of the
new image and other components can react to and consume the updated image.</p>
</div>
<div class="paragraph">
<p>Image data is stored in two locations. The actual image data is stored in a
configurable storage location such as cloud storage or a filesystem volume. The
image metadata, which is exposed by the standard cluster APIs and is used to
perform access control, is stored as standard API resources, specifically images
and imagestreams.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="registry-options">Registry options</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OpenShift Enterprise can build images from your source code, deploy them, and manage
their lifecycle. To enable this, OpenShift Enterprise provides an internal,
integrated container image registry that can be deployed in your OpenShift Enterprise
environment to locally manage images.</p>
</div>
<div class="sect2">
<h3 id="registry-integrated-openshift-registry-registry-options">Integrated OpenShift Enterprise registry</h3>
<div class="paragraph">
<p>OpenShift Enterprise provides a built in container image registry which runs as a
standard workload on the cluster. The registry is configured and managed by an
infrastructure operator. It provides an out of the box solution for users to
manage the images that run their workloads, and runs on top of the existing
cluster infrastructure. This registry can be scaled up or down like any other
cluster workload and does not require specific infrastructure provisioning. In
addition, it is integrated into the cluster user authentication and
authorization system which means that access to create and retrieve images is
controller by defining user permissions on the image resources.</p>
</div>
<div class="paragraph">
<p>The registry is typically used as a publication target for images built on the
cluster as well as a source of images for workloads running on the cluster.
When new a new image is pushed to the registry, the cluster is notified of the
new image and other components can react to and consume the updated image.</p>
</div>
<div class="paragraph">
<p>Image data is stored in two locations. The actual image data is stored in a
configurable storage location such as cloud storage or a filesystem volume. The
image metadata, which is exposed by the standard cluster APIs and is used to
perform access control, is stored as standard API resources, specifically images
and imagestreams.</p>
</div>
</div>
<div class="sect2">
<h3 id="registry-third-party-registries-registry-options">Third party registries</h3>
<div class="paragraph">
<p>OpenShift Enterprise can create containers using images from third party registries,
but it is unlikely that these registries offer the same image notification
support as the integrated OpenShift Enterprise registry. In this situation
OpenShift Enterprise will fetch tags from the remote registry upon imagestream
creation.</p>
</div>
<div class="paragraph">
<p>Refreshing the fetched tags is as simple as running <code>oc import-image
&lt;stream&gt;</code>. When new images are detected, the previously-described build and
deployment reactions occur.</p>
</div>
<div class="sect3">
<h4 id="_authentication">Authentication</h4>
<div class="paragraph">
<p>OpenShift Enterprise can communicate with registries to access private image
repositories using credentials supplied by the user. This allows OpenShift Enterprise
to push and pull images to and from private repositories.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="registry-quay-overview-registry-options">Red Hat Quay registries</h3>
<div class="paragraph">
<p>If you need an enterprise-quality container image registry, Red Hat Quay is
available both as a hosted service and as software you can install in your own
data center or cloud environment. Advanced registry features in Red Hat Quay
include geo-replication, image scanning, and the ability to roll back images.</p>
</div>
<div class="paragraph">
<p>Visit the Quay.io site to set up your own hosted Quay registry account. After
that, follow the Quay Tutorial to log in to the Quay registry and start managing
your images.</p>
</div>
<div class="paragraph">
<p>You can access your Red Hat Quay registry from OpenShift Enterprise like any remote
container image registry.</p>
</div>
</div>
<div class="sect2">
<h3 id="registry-authentication-enabled-registry-overview-registry-options">Authentication enabled Red Hat registry</h3>
<div class="paragraph">
<p>All container images available through the Red Hat Container Catalog are hosted
on an image registry, <code>registry.redhat.io</code>.</p>
</div>
<div class="paragraph">
<p>The registry, <code>registry.redhat.io</code>, requires authentication for access to
images and hosted content on OpenShift Enterprise. Following the move to the new
registry, the existing registry will be available for a period of time.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>OpenShift Enterprise pulls images from <code>registry.redhat.io</code>, so you must configure
your cluster to use it.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The new registry uses standard OAuth mechanisms for authentication,
with the following methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Authentication token.</strong>  Tokens, which are generated by administrators,
are service accounts that give systems the ability to authenticate against the
container image registry.
Service accounts are not affected by changes in user accounts, so the token
authentication method is reliable and resilient. This is the only supported
authentication option for production clusters.</p>
</li>
<li>
<p><strong>Web username and password.</strong> This is the standard set of credentials you use
to log in to resources such as <code>access.redhat.com</code>.
While it is possible to use this authentication method with OpenShift Enterprise, it
is not supported for production deployments. Restrict this authentication method
to stand-alone projects outside OpenShift Enterprise.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can use <code>podman login</code> with your credentials, either username and password
or authentication token, to access content on the new registry.</p>
</div>
<div class="paragraph">
<p>All imagestreams point to the new registry. Because the registry requires
authentication for access, the Samples Operator creates the
<code>samples-registry-credentials</code> secret.</p>
</div>
<div class="paragraph">
<p>You must place your credentials in two places:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>OpenShift namespace</strong>. Your credentials must exist in the OpenShift
namespace so that the imagestreams in the OpenShift namespace can import.</p>
</li>
<li>
<p><strong>Your host</strong>. Your credentials must exist on your host because Kubernetes
uses the credentials from your host when it goes to pull images.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="accessing-the-registry">Accessing the registry</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use the following sections for instructions on accessing the registry, including
viewing logs and metrics, as well as securing and exposing the registry.</p>
</div>
<div class="sect2">
<h3 id="registry-accessing-directly-accessing-the-registry">Accessing registry directly</h3>
<div class="paragraph">
<p>You can access the registry directly to invoke <code>podman</code> commands. This allows
you to push images to or pull them from the integrated registry directly using
operations like <code>podman push</code> or <code>podman pull</code>. To do so, you must be logged in
to the registry using the <code>oc registry login</code> command. The operations you can perform
depend on your user permissions, as described in the following sections.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>For any direct access, you must have a regular user for your preferred identity
provider.</p>
<div class="ulist">
<ul>
<li>
<p>A regular user can generate an access token required for logging in to
the registry.</p>
</li>
<li>
<p>System users, such as <strong>system:admin</strong>, cannot obtain access tokens
and, therefore, cannot access the registry directly.</p>
<div class="paragraph">
<p>For example, if you are using <code>HTPASSWD</code> authentication, you can create one
using the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># htpasswd /etc/origin/openshift-htpasswd &lt;user_name&gt;</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>For pulling images, for example when using the <code>podman pull</code> command,
the user must have the <strong>registry-viewer</strong> role. To add this role:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc policy add-role-to-user registry-viewer &lt;user_name&gt;</pre>
</div>
</div>
</li>
<li>
<p>For writing or pushing images, for example when using the <code>podman push</code> command,
the user must have the <strong>registry-editor</strong> role. To add this role:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc policy add-role-to-user registry-editor &lt;user_name&gt;</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Log in to the registry directly:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Ensure you are logged in to OpenShift Enterprise as a <strong>regular user</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc login</pre>
</div>
</div>
</li>
<li>
<p>Log in to the container image registry by using your access token:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">podman login -u openshift -p $(oc whoami -t) &lt;registry_ip&gt;:&lt;port&gt;</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>You can pass any value for the username, the token contains all necessary
information. Passing a username that contains colons will result in a login
failure.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Perform <code>podman pull</code> and <code>podman push</code> operations against your registry:</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>You can pull arbitrary images, but if you have the <strong>system:registry</strong> role
added, you can only push images to the registry in your project.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the following examples, use:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Component</th>
<th class="tableblock halign-left valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>&lt;registry_ip&gt;</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>172.30.124.220</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>&lt;port&gt;</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5000</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>&lt;project&gt;</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>openshift</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>&lt;image&gt;</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>busybox</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>&lt;tag&gt;</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">omitted (defaults to <code>latest</code>)</p></td>
</tr>
</tbody>
</table>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Pull an arbitrary image:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ podman pull docker.io/busybox</pre>
</div>
</div>
</li>
<li>
<p>Tag the new image with the form <code>&lt;registry_ip&gt;:&lt;port&gt;/&lt;project&gt;/&lt;image&gt;</code>.
The project name <strong>must</strong> appear in this pull specification for OpenShift Enterprise to
correctly place and later access the image in the registry:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ podman tag docker.io/busybox 172.30.124.220:5000/openshift/busybox</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Your regular user must have the <strong>system:image-builder</strong> role for the specified
project, which allows the user to write or push an image. Otherwise, the <code>podman
push</code> in the next step will fail. To test, you can create a new project to
push the <strong>busybox</strong> image.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Push the newly-tagged image to your registry:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ podman push 172.30.124.220:5000/openshift/busybox
...
cf2616975b4a: Image successfully pushed
Digest: sha256:3662dd821983bc4326bee12caec61367e7fb6f6a3ee547cbaff98f77403cab55</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="registry-viewing-contents-accessing-the-registry">Viewing the registry&#8217;s contents</h3>
<div class="paragraph">
<p>Tag and image metadata is stored in OpenShift Enterprise, but the registry stores
layer and signature data in a volume that is mounted into the registry container
at <strong><em>/registry</em></strong>. As <code>oc exec</code> does not work on privileged containers, to view a
registry&#8217;s contents you must manually SSH into the node housing the registry
pod&#8217;s container, then run <code>podman exec</code> on the container itself.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>List the current pods to find the pod name of your container image registry:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oc get pods</pre>
</div>
</div>
<div class="paragraph">
<p>Then, use <code>oc describe</code> to find the host name for the node running the
container:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oc describe pod &lt;pod_name&gt;</pre>
</div>
</div>
</li>
<li>
<p>Log into the desired node:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># ssh node.example.com</pre>
</div>
</div>
</li>
<li>
<p>List the running containers from the default project on the node host and identify the container ID for
the container image registry:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># podman ps --filter=name=registry_podman-registry.*_default_</pre>
</div>
</div>
</li>
<li>
<p>List the registry contents using the <code>oc rsh</code> command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oc rsh dc/podman-registry find /registry
/registry/podman
/registry/podman/registry
/registry/podman/registry/v2
/registry/podman/registry/v2/blobs <b class="conum">(1)</b>
/registry/podman/registry/v2/blobs/sha256
/registry/podman/registry/v2/blobs/sha256/ed
/registry/podman/registry/v2/blobs/sha256/ed/ede17b139a271d6b1331ca3d83c648c24f92cece5f89d95ac6c34ce751111810
/registry/podman/registry/v2/blobs/sha256/ed/ede17b139a271d6b1331ca3d83c648c24f92cece5f89d95ac6c34ce751111810/data <b class="conum">(2)</b>
/registry/podman/registry/v2/blobs/sha256/a3
/registry/podman/registry/v2/blobs/sha256/a3/a3ed95caeb02ffe68cdd9fd84406680ae93d633cb16422d00e8a7c22955b46d4
/registry/podman/registry/v2/blobs/sha256/a3/a3ed95caeb02ffe68cdd9fd84406680ae93d633cb16422d00e8a7c22955b46d4/data
/registry/podman/registry/v2/blobs/sha256/f7
/registry/podman/registry/v2/blobs/sha256/f7/f72a00a23f01987b42cb26f259582bb33502bdb0fcf5011e03c60577c4284845
/registry/podman/registry/v2/blobs/sha256/f7/f72a00a23f01987b42cb26f259582bb33502bdb0fcf5011e03c60577c4284845/data
/registry/podman/registry/v2/repositories <b class="conum">(3)</b>
/registry/podman/registry/v2/repositories/p1
/registry/podman/registry/v2/repositories/p1/pause <b class="conum">(4)</b>
/registry/podman/registry/v2/repositories/p1/pause/_manifests
/registry/podman/registry/v2/repositories/p1/pause/_manifests/revisions
/registry/podman/registry/v2/repositories/p1/pause/_manifests/revisions/sha256
/registry/podman/registry/v2/repositories/p1/pause/_manifests/revisions/sha256/e9a2ac6418981897b399d3709f1b4a6d2723cd38a4909215ce2752a5c068b1cf
/registry/podman/registry/v2/repositories/p1/pause/_manifests/revisions/sha256/e9a2ac6418981897b399d3709f1b4a6d2723cd38a4909215ce2752a5c068b1cf/signatures <b class="conum">(5)</b>
/registry/podman/registry/v2/repositories/p1/pause/_manifests/revisions/sha256/e9a2ac6418981897b399d3709f1b4a6d2723cd38a4909215ce2752a5c068b1cf/signatures/sha256
/registry/podman/registry/v2/repositories/p1/pause/_manifests/revisions/sha256/e9a2ac6418981897b399d3709f1b4a6d2723cd38a4909215ce2752a5c068b1cf/signatures/sha256/ede17b139a271d6b1331ca3d83c648c24f92cece5f89d95ac6c34ce751111810
/registry/podman/registry/v2/repositories/p1/pause/_manifests/revisions/sha256/e9a2ac6418981897b399d3709f1b4a6d2723cd38a4909215ce2752a5c068b1cf/signatures/sha256/ede17b139a271d6b1331ca3d83c648c24f92cece5f89d95ac6c34ce751111810/link <b class="conum">(6)</b>
/registry/podman/registry/v2/repositories/p1/pause/_uploads <b class="conum">(7)</b>
/registry/podman/registry/v2/repositories/p1/pause/_layers <b class="conum">(8)</b>
/registry/podman/registry/v2/repositories/p1/pause/_layers/sha256
/registry/podman/registry/v2/repositories/p1/pause/_layers/sha256/a3ed95caeb02ffe68cdd9fd84406680ae93d633cb16422d00e8a7c22955b46d4
/registry/podman/registry/v2/repositories/p1/pause/_layers/sha256/a3ed95caeb02ffe68cdd9fd84406680ae93d633cb16422d00e8a7c22955b46d4/link <b class="conum">(9)</b>
/registry/podman/registry/v2/repositories/p1/pause/_layers/sha256/f72a00a23f01987b42cb26f259582bb33502bdb0fcf5011e03c60577c4284845
/registry/podman/registry/v2/repositories/p1/pause/_layers/sha256/f72a00a23f01987b42cb26f259582bb33502bdb0fcf5011e03c60577c4284845/link</pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>This directory stores all layers and signatures as blobs.</p>
</li>
<li>
<p>This file contains the blob&#8217;s contents.</p>
</li>
<li>
<p>This directory stores all the image repositories.</p>
</li>
<li>
<p>This directory is for a single image repository <strong>p1/pause</strong>.</p>
</li>
<li>
<p>This directory contains signatures for a particular image manifest revision.</p>
</li>
<li>
<p>This file contains a reference back to a blob (which contains the signature
data).</p>
</li>
<li>
<p>This directory contains any layers that are currently being uploaded and
staged for the given repository.</p>
</li>
<li>
<p>This directory contains links to all the layers this repository references.</p>
</li>
<li>
<p>This file contains a reference to a specific layer that has been linked into
this repository via an image.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="registry-viewing-logs-accessing-the-registry">Viewing registry logs</h3>
<div class="paragraph">
<p>You can view the logs for the registry by using the <code>oc logs</code> command.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Use the <code>oc logs</code> command with the DeploymentConfig to view the logs
for the container image registry:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc logs dc/podman-registry
2015-05-01T19:48:36.300593110Z time="2015-05-01T19:48:36Z" level=info msg="version=v2.0.0+unknown"
2015-05-01T19:48:36.303294724Z time="2015-05-01T19:48:36Z" level=info msg="redis not configured" instance.id=9ed6c43d-23ee-453f-9a4b-031fea646002
2015-05-01T19:48:36.303422845Z time="2015-05-01T19:48:36Z" level=info msg="using inmemory layerinfo cache" instance.id=9ed6c43d-23ee-453f-9a4b-031fea646002
2015-05-01T19:48:36.303433991Z time="2015-05-01T19:48:36Z" level=info msg="Using OpenShift Auth handler"
2015-05-01T19:48:36.303439084Z time="2015-05-01T19:48:36Z" level=info msg="listening on :5000" instance.id=9ed6c43d-23ee-453f-9a4b-031fea646002</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="registry-accessing-metrics-accessing-the-registry">Accessing registry metrics</h3>
<div class="paragraph">
<p>The OpenShift Container Registry provides an endpoint for
<a href="https://prometheus.io/docs/introduction/overview/">Prometheus metrics</a>.
Prometheus is a stand-alone, open source systems monitoring and alerting
toolkit.</p>
</div>
<div class="paragraph">
<p>The metrics are exposed at the <strong><em>/extensions/v2/metrics</em></strong> path of the registry
endpoint. However, this route must first be enabled; see
Extended Registry Configuration for instructions.</p>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>There are two ways in which you can access the metrics: running a metrics query
or by using the cluster role.</p>
</div>
<div class="paragraph">
<p><strong>Metrics query</strong>
. Run a metrics query, for example:</p>
</div>
<div class="paragraph">
<p>+</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl -s -u &lt;user&gt;:&lt;secret&gt; \ <b class="conum">(1)</b>
    http://172.30.30.30:5000/extensions/v2/metrics | grep openshift | head -n 10

# HELP openshift_build_info A metric with a constant '1' value labeled by major, minor, git commit &amp; git version from which OpenShift was built.
# TYPE openshift_build_info gauge
openshift_build_info{gitCommit="67275e1",gitVersion="v3.6.0-alpha.1+67275e1-803",major="3",minor="6+"} 1
# HELP openshift_registry_request_duration_seconds Request latency summary in microseconds for each operation
# TYPE openshift_registry_request_duration_seconds summary
openshift_registry_request_duration_seconds{name="test/origin-pod",operation="blobstore.create",quantile="0.5"} 0
openshift_registry_request_duration_seconds{name="test/origin-pod",operation="blobstore.create",quantile="0.9"} 0
openshift_registry_request_duration_seconds{name="test/origin-pod",operation="blobstore.create",quantile="0.99"} 0
openshift_registry_request_duration_seconds_sum{name="test/origin-pod",operation="blobstore.create"} 0
openshift_registry_request_duration_seconds_count{name="test/origin-pod",operation="blobstore.create"} 5</pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><code>&lt;user&gt;</code> can be arbitrary, but <code>&lt;secret&gt;</code> must match the value specified in the
registry configuration.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Cluster role</strong>
. Create a cluster role if you do not already have one to access the metrics:</p>
</div>
<div class="paragraph">
<p>+</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ cat &lt;&lt;EOF |
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: prometheus-scraper
rules:
- apiGroups:
  - image.openshift.io
  resources:
  - registry/metrics
  verbs:
  - get
EOF
$ oc create -f -</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add this role to a user, run the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc adm policy add-cluster-role-to-user prometheus-scraper &lt;username&gt;</pre>
</div>
</div>
</li>
<li>
<p>Access the metrics using cluster role. You still need to
enable the endpoint, but you do not need to specify a <code>&lt;secret&gt;</code>. The part of
the configuration file responsible for metrics should look like this:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">openshift:
  version: 1.0
  metrics:
    enabled: true
...</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="securing-and-exposing-the-registry">Securing and exposing the registry</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, the OpenShift Enterprise registry is secured during cluster
installation so that it serves traffic via TLS. A passthrough route is also
created by default to expose the service externally.</p>
</div>
<div class="sect2">
<h3 id="registry-securing-manually-securing-exposing-registry">Securing the registry manually</h3>
<div class="paragraph">
<p>If for any reason your registry has not been secured, see the following
sections for steps on how to manually do so.</p>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>Manually secure the registry to serve traffic via TLS:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Deploy the registry using the <code>oc adm registry</code> command as a
user with cluster administrator privileges, for example:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc adm registry --config=/etc/origin/master/admin.kubeconfig \//<b class="conum">(1)</b>
    --service-account=registry \//<b class="conum">(2)</b>
    --images='registry.redhat.io/openshift3/ose-${component}:${version}' <b class="conum">(3)</b></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p><code>--config</code> is the path to the CLI configuration file for
the cluster administrator.</p>
</li>
<li>
<p><code>--service-account</code> is the service account used to run the registry&#8217;s pod.</p>
</li>
<li>
<p>Required to pull the correct image for OpenShift Enterprise.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Fetch the service IP and port of the registry:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc get svc/podman-registry
NAME              LABELS                                    SELECTOR                  IP(S)            PORT(S)
podman-registry   podman-registry=default                   podman-registry=default   172.30.124.220   5000/TCP</pre>
</div>
</div>
</li>
<li>
<p>You can use an existing server certificate, or create a key and server
certificate valid for specified IPs and host names, signed by a specified CA. To
create a server certificate for the registry service IP and the
<strong>podman-registry.default.svc.cluster.local</strong> host name,
run the following command from the first master listed in the Ansible host inventory file,
by default <strong><em>/etc/ansible/hosts</em></strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc adm ca create-server-cert \
    --signer-cert=/etc/origin/master/ca.crt \
    --signer-key=/etc/origin/master/ca.key \
    --signer-serial=/etc/origin/master/ca.serial.txt \
    --hostnames='podman-registry.default.svc.cluster.local,podman-registry.default.svc,172.30.124.220' \
    --cert=/etc/secrets/registry.crt \
    --key=/etc/secrets/registry.key</pre>
</div>
</div>
<div class="paragraph">
<p>If the router will be exposed externally, add the public route host name in the
<code>--hostnames</code> flag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">--hostnames='mypodman-registry.example.com,podman-registry.default.svc.cluster.local,172.30.124.220 \</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>oc adm ca create-server-cert</code> command generates a certificate that is valid
for two years. This can be altered with the <code>--expire-days</code> option, but for
security reasons, it is recommended to not make it greater than this value.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Create the secret for the registry certificates:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc create secret generic registry-certificates \
    --from-file=/etc/secrets/registry.crt \
    --from-file=/etc/secrets/registry.key</pre>
</div>
</div>
</li>
<li>
<p>Add the secret to the registry pod&#8217;s service accounts (including the <strong>default</strong>
service account):</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc secrets link registry registry-certificates
$ oc secrets link default  registry-certificates</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Limiting secrets to only the service accounts that reference them is disabled by
default. This means that if <code>serviceAccountConfig.limitSecretReferences</code> is set
to <code>false</code> (the default setting) in the master configuration file, linking
secrets to a service is not required.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Pause the <code>podman-registry</code> service:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc rollout pause dc/podman-registry</pre>
</div>
</div>
</li>
<li>
<p>Add the secret volume to the registry DeploymentConfig:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc set volume dc/podman-registry --add --type=secret \
    --secret-name=registry-certificates -m /etc/secrets</pre>
</div>
</div>
</li>
<li>
<p>Enable TLS by adding the following environment variables to the registry
DeploymentConfig:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc set env dc/podman-registry \
    REGISTRY_HTTP_TLS_CERTIFICATE=/etc/secrets/registry.crt \
    REGISTRY_HTTP_TLS_KEY=/etc/secrets/registry.key</pre>
</div>
</div>
</li>
<li>
<p>Update the scheme used for the registry&#8217;s liveness probe from HTTP to HTTPS:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc patch dc/podman-registry -p '{"spec": {"template": {"spec": {"containers":[{
    "name":"registry",
    "livenessProbe":  {"httpGet": {"scheme":"HTTPS"}}
  }]}}}}'</pre>
</div>
</div>
</li>
<li>
<p>Resume the <code>podman-registry</code> service:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc rollout resume dc/podman-registry</pre>
</div>
</div>
</li>
<li>
<p>Validate the registry is running in TLS mode. Wait until the latest <strong>podman-registry</strong>
deployment completes and verify the Podman logs for the registry container. You should
find an entry for <code>listening on :5000, tls</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc logs dc/podman-registry | grep tls
time="2015-05-27T05:05:53Z" level=info msg="listening on :5000, tls" instance.id=deeba528-c478-41f5-b751-dc48e4935fc2</pre>
</div>
</div>
</li>
<li>
<p>Copy the CA certificate to the Podman certificates directory. This must be
done on all nodes in the cluster:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ dcertsdir=/etc/podman/certs.d
$ destdir_addr=$dcertsdir/172.30.124.220:5000
$ destdir_name=$dcertsdir/podman-registry.default.svc.cluster.local:5000

$ sudo mkdir -p $destdir_addr $destdir_name
$ sudo cp ca.crt $destdir_addr    //<b class="conum">(1)</b>
$ sudo cp ca.crt $destdir_name</pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The <strong><em>ca.crt</em></strong> file is a copy
of <strong><em>/etc/origin/master/ca.crt</em></strong> on the master.</p>
</li>
</ol>
</div>
</li>
<li>
<p>When using authentication, some versions of <code>podman</code> also require you to
configure your cluster to trust the certificate at the OS level.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Copy the certificate:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ cp /etc/origin/master/ca.crt /etc/pki/ca-trust/source/anchors/myregistrydomain.com.crt</pre>
</div>
</div>
</li>
<li>
<p>Run:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ update-ca-trust enable</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Remove the <code>--insecure-registry</code> option only for this particular registry in
the <strong><em>/etc/sysconfig/podman</em></strong> file. Then, reload the daemon and restart the
<strong>podman</strong> service to reflect this configuration change:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ sudo systemctl daemon-reload
$ sudo systemctl restart podman</pre>
</div>
</div>
</li>
<li>
<p>Validate the <code>podman</code> client connection. Running <code>podman push</code>
to the registry or <code>podman pull</code> from the registry should succeed. Make sure you have
logged into the registry.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ podman tag|push &lt;registry/image&gt; &lt;internal_registry/project/image&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ podman pull busybox
$ podman tag docker.io/busybox 172.30.124.220:5000/openshift/busybox
$ podman push 172.30.124.220:5000/openshift/busybox
...
cf2616975b4a: Image successfully pushed
Digest: sha256:3662dd821983bc4326bee12caec61367e7fb6f6a3ee547cbaff98f77403cab55</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="registry-exposing-secure-registry-manually-securing-exposing-registry">Exposing a secure registry manually</h3>
<div class="paragraph">
<p>Instead of logging in to the OpenShift Enterprise registry from within the
OpenShift Enterprise cluster, you can gain external access to it by first securing
the registry and then exposing it with a route. This allows you to log in to the
registry from outside the cluster using the route address, and to tag and push
images using the route host.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites:</div>
<ul>
<li>
<p>The following prerequisites are automatically preformed:</p>
<div class="ulist">
<ul>
<li>
<p>Deploy the registry.</p>
</li>
<li>
<p>Secure the registry.</p>
</li>
<li>
<p>Deploy a router.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Verify whether a passthrough route exists, the route should have been created by
default for the registry during the initial cluster installation:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc get route/pod-registry -o yaml
apiVersion: v1
kind: Route
metadata:
  name: podman-registry
spec:
  host: &lt;host&gt; <b class="conum">(1)</b>
  to:
    kind: Service
    name: podman-registry <b class="conum">(2)</b>
  tls:
    termination: passthrough <b class="conum">(3)</b></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The host for your route. You must be able to resolve this name externally by
DNS to the router&#8217;s IP address.</p>
</li>
<li>
<p>The service name for your registry.</p>
</li>
<li>
<p>Specifies this route as a passthrough route.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Re-encrypt routes are also supported for exposing the secure registry.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If it does not exist, create the route with the <code>oc create route passthrough</code>
command, specifying the registry as the route’s service. By default, the name of
the created route is the same as the service name:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Get the <strong>podman-registry</strong> service details:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc get svc
NAME              CLUSTER_IP       EXTERNAL_IP   PORT(S)                 SELECTOR                  AGE
podman-registry   172.30.69.167    &lt;none&gt;        5000/TCP                podman-registry=default   4h
kubernetes        172.30.0.1       &lt;none&gt;        443/TCP,53/UDP,53/TCP   &lt;none&gt;                    4h
router            172.30.172.132   &lt;none&gt;        80/TCP                  router=router             4h</pre>
</div>
</div>
</li>
<li>
<p>Create the route:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc create route passthrough    \
    --service=podman-registry    \//<b class="conum">(1)</b>
    --hostname=&lt;host&gt;
route "podman-registry" created     <b class="conum">(2)</b></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Specifies the registry as the route&#8217;s service.</p>
</li>
<li>
<p>The route name is identical to the service name.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Trust the certificates being used for the registry on your host
system to allow the host to push and pull images. The certificates referenced
were created when you secured your registry:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ sudo mkdir -p /etc/podman/certs.d/&lt;host&gt;
$ sudo cp &lt;ca_certificate_file&gt; /etc/podman/certs.d/&lt;host&gt;
$ sudo systemctl restart podman</pre>
</div>
</div>
</li>
<li>
<p>Log in to the registry using the information from securing the registry.
However, this time point to the host name used in the route rather than your
service IP. When logging in to a secured and exposed registry, make sure you
specify the registry in the <code>podman login</code> command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># podman login -e user@company.com \
    -u f83j5h6 \
    -p Ju1PeM47R0B92Lk3AZp-bWJSck2F7aGCiZ66aFGZrs2 \
    &lt;host&gt;</pre>
</div>
</div>
</li>
<li>
<p>You can now tag and push images using the route host. For example, to tag and
push a <code>busybox</code> image in a project called <code>test</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc get imagestreams -n test
NAME      PODMAN REPO   TAGS      UPDATED

$ podman pull busybox
$ podman tag busybox &lt;host&gt;/test/busybox
$ podman push &lt;host&gt;/test/busybox
The push refers to a repository [&lt;host&gt;/test/busybox] (len: 1)
8c2e06607696: Image already exists
6ce2e90b0bc7: Image successfully pushed
cf2616975b4a: Image successfully pushed
Digest: sha256:6c7e676d76921031532d7d9c0394d0da7c2906f4cb4c049904c4031147d8ca31

$ podman pull &lt;host&gt;/test/busybox
latest: Pulling from &lt;host&gt;/test/busybox
cf2616975b4a: Already exists
6ce2e90b0bc7: Already exists
8c2e06607696: Already exists
Digest: sha256:6c7e676d76921031532d7d9c0394d0da7c2906f4cb4c049904c4031147d8ca31
Status: Image is up to date for &lt;host&gt;/test/busybox:latest

$ oc get imagestreams -n test
NAME      PODMAN REPO                       TAGS      UPDATED
busybox   172.30.11.215:5000/test/busybox   latest    2 seconds ago</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Your imagestreams will have the IP address and port of the registry service,
not the route name and port. See <code>oc get imagestreams</code> for details.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="registry-exposing-non-secure-registry-manually-securing-exposing-registry">Exposing a non-secure registry manually</h3>
<div class="paragraph">
<p>Instead of securing the registry in order to expose the registry, you can simply
expose a non-secure registry for non-production OpenShift Enterprise environments.
This allows you to have an external route to the registry without using SSL
certificates.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Only non-production environments should expose a non-secure registry to external access.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>To expose a non-secure registry:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Expose the registry:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oc expose service podman-registry --hostname=&lt;hostname&gt; -n default</pre>
</div>
</div>
<div class="paragraph">
<p>This creates the following JSON file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">apiVersion: v1
kind: Route
metadata:
  creationTimestamp: null
  labels:
    podman-registry: default
  name: podman-registry
spec:
  host: registry.example.com
  port:
    targetPort: "5000"
  to:
    kind: Service
    name: podman-registry
status: {}</pre>
</div>
</div>
</li>
<li>
<p>Verify that the route has been created successfully:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oc get route
NAME              HOST/PORT                    PATH      SERVICE           LABELS                    INSECURE POLICY   TLS TERMINATION
podman-registry   registry.example.com            podman-registry   podman-registry=default</pre>
</div>
</div>
</li>
<li>
<p>Check the health of the registry:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl -v http://registry.example.com/healthz</pre>
</div>
</div>
<div class="paragraph">
<p>Expect an HTTP 200/OK message.</p>
</div>
<div class="paragraph">
<p>After exposing the registry, update your <strong><em>/etc/sysconfig/podman</em></strong> file by
adding the port number to the <code>OPTIONS</code> entry. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">OPTIONS='--selinux-enabled --insecure-registry=172.30.0.0/16 --insecure-registry registry.example.com:80'</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>The options in the previous example should be added on the client from which you
are trying to log in.</p>
</div>
<div class="paragraph">
<p>Also, ensure that Podman is running on the client.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>When logging in to the non-secured and exposed registry, make sure you specify the registry
in the <code>podman login</code> command. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># podman login -e user@company.com \
    -u f83j5h6 \
    -p Ju1PeM47R0B92Lk3AZp-bWJSck2F7aGCiZ66aFGZrs2 \
    &lt;host&gt;</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2019-04-12 23:56:12 UTC
</div>
</div>
</body>
</html>